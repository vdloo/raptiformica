{
  "raptiformica_api_version": "0.1",
  "compute": {
    "docker": {
      "headless": {
        "available": "docker -v",
        "source": "https://github.com/vdloo/dockerfiles",
        "start_instance": "cd ubuntu64 && chmod 0600 insecure_key && ssh-add insecure_key && sudo docker build -t raptiformica-baseimage . && sudo docker run --privileged -d raptiformica-baseimage > container_id && sleep 5",
        "get_hostname": "bash -c \"sudo docker inspect -f '{{ .NetworkSettings.IPAddress }}' $(cat ubuntu64/container_id)\" | tail -n 1",
        "get_port": "echo 22",
        "detect_stale_instance": "bash -c 'cd ubuntu64 && [ -f container_id ] && sudo docker ps --no-trunc | grep -f container_id'",
        "clean_up_instance_command": "bash -c 'cd ubuntu64; [ -f container_id ] && (cat container_id | xargs sudo docker kill -9 || /bin/true; cat container_id | xargs sudo docker rm -f || /bin/true')"
      }
    }
  }
}
